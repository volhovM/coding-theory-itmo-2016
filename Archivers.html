<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-12-18 Sun 17:13 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Information theory: HW #3 solution</title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Volkhov Mikhail, M3338" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Information theory: HW #3 solution</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. Task objectives, format, prerequisites</a></li>
<li><a href="#orgheadline2">2. Two-pass huffman coding</a></li>
<li><a href="#orgheadline3">3. Adaptive arithmetic coding</a></li>
<li><a href="#orgheadline4">4. Enumerative</a></li>
<li><a href="#orgheadline5">5. LZ77</a></li>
<li><a href="#orgheadline6">6. LZW</a></li>
<li><a href="#orgheadline7">7. PPM</a></li>
<li><a href="#orgheadline8">8. Burrows-Wheeler + book stack</a></li>
<li><a href="#orgheadline9">9. Standart archiving</a></li>
<li><a href="#orgheadline10">10. Comparison and summary</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> Task objectives, format, prerequisites</h2>
<div class="outline-text-2" id="text-1">
<p>
So the task is to implement several algorithms of data compression
and provide reports on them. Reports will contain logs from
algorithms that will show how it operates this data. Tables with
explanation will be attached. I won't attach haskell snippets this
time as they became really big and complex. Instead, i'll put it
into another pdf and send it with this one.
</p>

<p>
Proverb correspondent to my task is the following:
</p>

<blockquote>
<p>
<i>Love the heart that hurts you, but never hurt the heart that loves you.</i>
</p>
</blockquote>

<p>
It's in english that's why I'll stick to utf-8/ascii encoding as
byte representation. It contains \(71\) letters, so it takes \(568\)
bytes if used without any coding.
</p>

<p>
Remark: sorry, but my rendering format doesn't support proper
underscore marks (_) &#x2013; they turn into underlines and i see no way
to escape them. "␣" can be used instead, but it's too ugly. I'll use
it when ambiguous, and just leave empty place in other places. Yes,
and sorry for the tables. They're ugly both when they're are and are
not full-width. Rule of thumb: use the same table formatting as in
the textbook. So I choose to use full width.
</p>
</div>
</div>
<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> Two-pass huffman coding</h2>
<div class="outline-text-2" id="text-2">
<p>
I've implemented regural huffman coding, as it can be seen from the
first table: code words of the same length are sorted
lexicographically:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Char\)</th>
<th scope="col" class="org-right">\(Codeword\)</th>
<th scope="col" class="org-right">\(Frequency\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">00</td>
<td class="org-right">13</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">010</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">011</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">100</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">1010</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">1011</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-right">11000</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">11001</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">11010</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-right">11011</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-right">11100</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-right">111010</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-right">111011</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-right">111100</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-right">111101</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-right">111110</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-right">111111</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>

<p>
And the second pass completes encoding:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(C\)</th>
<th scope="col" class="org-left">\(P(C)\)</th>
<th scope="col" class="org-right">\(Codeword\)</th>
<th scope="col" class="org-right">\(L(S)\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">L</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111110</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11100</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">3 / 71</td>
<td class="org-right">11010</td>
<td class="org-right">16</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">19</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">21</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">24</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">27</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">30</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">32</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">35</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">38</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11011</td>
<td class="org-right">43</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1010</td>
<td class="org-right">47</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">52</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">55</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">58</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11011</td>
<td class="org-right">63</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">66</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">68</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">71</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1011</td>
<td class="org-right">75</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1010</td>
<td class="org-right">79</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">82</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">2 / 71</td>
<td class="org-right">11000</td>
<td class="org-right">87</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">89</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">2 / 71</td>
<td class="org-right">11001</td>
<td class="org-right">94</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11100</td>
<td class="org-right">99</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1011</td>
<td class="org-right">103</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111010</td>
<td class="org-right">109</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">111</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111111</td>
<td class="org-right">117</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1011</td>
<td class="org-right">121</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">124</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">126</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111101</td>
<td class="org-right">132</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">135</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">3 / 71</td>
<td class="org-right">11010</td>
<td class="org-right">140</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">143</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1010</td>
<td class="org-right">147</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">149</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">152</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1011</td>
<td class="org-right">156</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1010</td>
<td class="org-right">160</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">163</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">165</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">168</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">171</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">174</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">176</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">179</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">182</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11011</td>
<td class="org-right">187</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1010</td>
<td class="org-right">191</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">194</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">196</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">199</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">8 / 71</td>
<td class="org-right">011</td>
<td class="org-right">202</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11011</td>
<td class="org-right">207</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">11 / 71</td>
<td class="org-right">100</td>
<td class="org-right">210</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">212</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111100</td>
<td class="org-right">218</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11100</td>
<td class="org-right">223</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">3 / 71</td>
<td class="org-right">11010</td>
<td class="org-right">228</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">8 / 71</td>
<td class="org-right">010</td>
<td class="org-right">231</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">2 / 71</td>
<td class="org-right">11000</td>
<td class="org-right">236</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">13 / 71</td>
<td class="org-right">00</td>
<td class="org-right">238</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">2 / 71</td>
<td class="org-right">11001</td>
<td class="org-right">243</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">4 / 71</td>
<td class="org-right">11100</td>
<td class="org-right">248</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">5 / 71</td>
<td class="org-right">1011</td>
<td class="org-right">252</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">1 / 71</td>
<td class="org-right">111011</td>
<td class="org-right">258</td>
</tr>
</tbody>
</table>

<p>
Encoded proverb encoded is \(l_2 = 258\) bits, while data amount needed to
transfer huffman tree should be calculated manually. First, to
transfer the tree itself, it's sufficient to pass only \(19\) bits
(calculated manually using table 3.3 from the study book).
</p>

\begin{align*}
\left\lceil\log{\dbinom{256}{1}}\right\rceil +
\left\lceil\log{\dbinom{255}{3}}\right\rceil +
\left\lceil\log{\dbinom{254}{2}}\right\rceil +
\left\lceil\log{\dbinom{253}{5}}\right\rceil +
\left\lceil\log{\dbinom{252}{6}}\right\rceil = 117
\end{align*}

<p>
So totally \(l_1 = 19 + 117 = 136\), and total length is \(l = l_1+l_2 =
  394\) bits. Much better than raw \(568\) bits.
</p>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">3</span> Adaptive arithmetic coding</h2>
<div class="outline-text-2" id="text-3">
<p>
Implementation uses renormalization together with fixed-point
precision arithmetics (16 bits words). Algorithm "A" from textbook
is used (has \(n+1\) in denominator).
</p>

<p>
Here is the table algorithm outputs (backslash stands for escape
symbol):
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(C\)</th>
<th scope="col" class="org-left">\(P(C)\)</th>
<th scope="col" class="org-right">\(Codeword\)</th>
<th scope="col" class="org-right">\(L(S)\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 1</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-left">1 / 256</td>
<td class="org-right">0100110</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 2</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">1 / 255</td>
<td class="org-right">00110111</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 3</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">1 / 254</td>
<td class="org-right">0001010</td>
<td class="org-right">22</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 4</td>
<td class="org-right">00010</td>
<td class="org-right">27</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">1 / 253</td>
<td class="org-right">0100101</td>
<td class="org-right">34</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 5</td>
<td class="org-right">010</td>
<td class="org-right">37</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">1 / 252</td>
<td class="org-right">00111001</td>
<td class="org-right">45</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 6</td>
<td class="org-right">100</td>
<td class="org-right">48</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">1 / 251</td>
<td class="org-right">0101110</td>
<td class="org-right">55</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 7</td>
<td class="org-right">01</td>
<td class="org-right">57</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">1 / 250</td>
<td class="org-right">000110001</td>
<td class="org-right">66</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">1 / 8</td>
<td class="org-right">001</td>
<td class="org-right">69</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">1 / 9</td>
<td class="org-right">00</td>
<td class="org-right">71</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">1 / 10</td>
<td class="org-right">0</td>
<td class="org-right">72</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">2 / 11</td>
<td class="org-right">0000</td>
<td class="org-right">76</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 12</td>
<td class="org-right">0</td>
<td class="org-right">77</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">1 / 249</td>
<td class="org-right">000001000</td>
<td class="org-right">86</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 13</td>
<td class="org-right">00011</td>
<td class="org-right">91</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">1 / 248</td>
<td class="org-right">00100000</td>
<td class="org-right">99</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">1 / 14</td>
<td class="org-right">0</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">2 / 15</td>
<td class="org-right">000000</td>
<td class="org-right">106</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">1 / 8</td>
<td class="org-right">010</td>
<td class="org-right">109</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">2 / 17</td>
<td class="org-right">001</td>
<td class="org-right">112</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">1 / 18</td>
<td class="org-right">0001</td>
<td class="org-right">116</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">3 / 19</td>
<td class="org-right">0</td>
<td class="org-right">117</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">3 / 20</td>
<td class="org-right">00000</td>
<td class="org-right">122</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">1 / 7</td>
<td class="org-right">0</td>
<td class="org-right">123</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 22</td>
<td class="org-right">001000</td>
<td class="org-right">129</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">1 / 247</td>
<td class="org-right">0010110</td>
<td class="org-right">136</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">1 / 23</td>
<td class="org-right">00100</td>
<td class="org-right">141</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">1 / 6</td>
<td class="org-right">0</td>
<td class="org-right">142</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 25</td>
<td class="org-right">0001</td>
<td class="org-right">146</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">1 / 246</td>
<td class="org-right">0000011</td>
<td class="org-right">153</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">2 / 13</td>
<td class="org-right">0000000</td>
<td class="org-right">160</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 27</td>
<td class="org-right">101</td>
<td class="org-right">163</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">1 / 245</td>
<td class="org-right">000101111</td>
<td class="org-right">172</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">1 / 28</td>
<td class="org-right">00111</td>
<td class="org-right">177</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">1 / 29</td>
<td class="org-right">011</td>
<td class="org-right">180</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 30</td>
<td class="org-right">0010001</td>
<td class="org-right">187</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-left">1 / 244</td>
<td class="org-right">00011011</td>
<td class="org-right">195</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">5 / 31</td>
<td class="org-right">00</td>
<td class="org-right">197</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 32</td>
<td class="org-right">011001</td>
<td class="org-right">203</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">1 / 243</td>
<td class="org-right">010</td>
<td class="org-right">206</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">2 / 33</td>
<td class="org-right">000001</td>
<td class="org-right">212</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">5 / 34</td>
<td class="org-right">00010</td>
<td class="org-right">217</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">6 / 35</td>
<td class="org-right">000</td>
<td class="org-right">220</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 36</td>
<td class="org-right">101</td>
<td class="org-right">223</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-left">1 / 242</td>
<td class="org-right">0001000011</td>
<td class="org-right">233</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">3 / 37</td>
<td class="org-right">0</td>
<td class="org-right">234</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">1 / 38</td>
<td class="org-right">000110</td>
<td class="org-right">240</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">4 / 39</td>
<td class="org-right">000</td>
<td class="org-right">243</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">1 / 20</td>
<td class="org-right">0001</td>
<td class="org-right">247</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">7 / 41</td>
<td class="org-right">00000</td>
<td class="org-right">252</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">2 / 21</td>
<td class="org-right">010</td>
<td class="org-right">255</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">3 / 43</td>
<td class="org-right">011</td>
<td class="org-right">258</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">3 / 44</td>
<td class="org-right">001</td>
<td class="org-right">261</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">2 / 15</td>
<td class="org-right">00</td>
<td class="org-right">263</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">4 / 23</td>
<td class="org-right">00000</td>
<td class="org-right">268</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">7 / 47</td>
<td class="org-right">01</td>
<td class="org-right">270</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">5 / 48</td>
<td class="org-right">00</td>
<td class="org-right">272</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">5 / 49</td>
<td class="org-right">000010</td>
<td class="org-right">278</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">9 / 50</td>
<td class="org-right">00</td>
<td class="org-right">280</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">2 / 17</td>
<td class="org-right">0</td>
<td class="org-right">281</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">3 / 26</td>
<td class="org-right">00001</td>
<td class="org-right">286</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">2 / 53</td>
<td class="org-right">00</td>
<td class="org-right">288</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">2 / 27</td>
<td class="org-right">00001</td>
<td class="org-right">293</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">8 / 55</td>
<td class="org-right">00</td>
<td class="org-right">295</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">5 / 28</td>
<td class="org-right">00000</td>
<td class="org-right">300</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">3 / 19</td>
<td class="org-right">011</td>
<td class="org-right">303</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">7 / 58</td>
<td class="org-right">01</td>
<td class="org-right">305</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">3 / 59</td>
<td class="org-right">0001</td>
<td class="org-right">309</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">1 / 6</td>
<td class="org-right">0</td>
<td class="org-right">310</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">11 / 61</td>
<td class="org-right">00000</td>
<td class="org-right">315</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 62</td>
<td class="org-right">100011</td>
<td class="org-right">321</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-left">1 / 241</td>
<td class="org-right">001111</td>
<td class="org-right">327</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">2 / 63</td>
<td class="org-right">0001011</td>
<td class="org-right">334</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">1 / 32</td>
<td class="org-right">1001</td>
<td class="org-right">338</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">7 / 65</td>
<td class="org-right">00</td>
<td class="org-right">340</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">1 / 66</td>
<td class="org-right">0001</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">12 / 67</td>
<td class="org-right">0000000</td>
<td class="org-right">351</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">1 / 68</td>
<td class="org-right">1</td>
<td class="org-right">352</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">1 / 23</td>
<td class="org-right">000000110</td>
<td class="org-right">361</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">2 / 35</td>
<td class="org-right">100</td>
<td class="org-right">364</td>
</tr>

<tr>
<td class="org-left">esc</td>
<td class="org-left">1 / 71</td>
<td class="org-right">0100100</td>
<td class="org-right">371</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">1 / 240</td>
<td class="org-right">0001100</td>
<td class="org-right">378</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">final</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">1000111</td>
<td class="org-right">385</td>
</tr>
</tbody>
</table>

<p>
On every step algorithm saves 16-digit high and low variables. If
the interval we go into is small enough that new bounds share most
significant bits, we put them on the wire. This algorithm is
decribed both in textbook and on wikipedia<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> and also in Amir
Said's article "Introduction to Arithmetic Coding"<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>. Thus empty
spaces in third column mean that interval didn't satisfy this
property. So eventually it took \(385\) bits to encode the proverb,
better than huffman.
</p>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">4</span> Enumerative</h2>
<div class="outline-text-2" id="text-4">
<p>
First of all I emphasize that no <i>real encoder</i> will be implemented,
i'll just present here an estimate on how much information will it
take. Enumerative encoding implementation seems complex and
impractical to do.
</p>

<p>
Here's the main function that calculates length of the input.
</p>
<div class="org-src-container">

<pre class="src src-haskell"><span style="color: #8AAFFA;">enumerative</span><span style="color: #333333;"> </span><span style="color: #A197BF;">::</span><span style="color: #333333;"> </span><span style="color: #EF5C5F;">BS.ByteString</span><span style="color: #333333;"> </span><span style="color: #A197BF;">-&gt;</span><span style="color: #333333;"> </span><span style="color: #EF5C5F;">Integer</span>
<span style="color: #8AAFFA;">enumerative</span><span style="color: #333333;"> </span>input<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>l1<span style="color: #333333;"> </span><span style="color: #A197BF;">+</span><span style="color: #333333;"> </span>l2
<span style="color: #333333;">  </span><span style="color: #FFA070;">where</span>
<span style="color: #333333;">    </span>n<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>fromIntegral<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>BS.length<span style="color: #333333;"> </span>input
<span style="color: #333333;">    </span>chars<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>BS.unpack<span style="color: #333333;"> </span>input
<span style="color: #333333;">    </span>unique<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>nub<span style="color: #333333;"> </span>chars
<span style="color: #333333;">    </span>occurences<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span>
<span style="color: #333333;">        </span>M.fromList<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span>
<span style="color: #333333;">        </span>map<span style="color: #333333;"> </span>(<span style="color: #A197BF;">\</span>i<span style="color: #333333;"> </span><span style="color: #A197BF;">-&gt;</span><span style="color: #333333;"> </span>(i,<span style="color: #333333;"> </span>fromIntegral<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>length<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>filter<span style="color: #333333;"> </span>(<span style="color: #A197BF;">==</span><span style="color: #333333;"> </span>i)<span style="color: #333333;"> </span>chars))<span style="color: #333333;"> </span>unique
<span style="color: #333333;">    </span>comp,<span style="color: #333333;"> </span>compcomp,<span style="color: #333333;"> </span>comp'<span style="color: #333333;"> </span><span style="color: #A197BF;">::</span><span style="color: #333333;"> </span>[<span style="color: #EF5C5F;">Integer</span>]
<span style="color: #333333;">    </span>comp<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>reverse<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span>
<span style="color: #333333;">           </span>sort<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>map<span style="color: #333333;"> </span>(<span style="color: #A197BF;">\</span>i<span style="color: #333333;"> </span><span style="color: #A197BF;">-&gt;</span><span style="color: #333333;"> </span>fromMaybe<span style="color: #333333;"> </span>0<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>M.lookup<span style="color: #333333;"> </span>i<span style="color: #333333;"> </span>occurences)<span style="color: #333333;"> </span>[0<span style="color: #333333;"> </span><span style="color: #A197BF;">..</span><span style="color: #333333;"> </span>0xff]
<span style="color: #333333;">    </span>m<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>length<span style="color: #333333;"> </span>comp
<span style="color: #333333;">    </span>compcomp<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>map<span style="color: #333333;"> </span>(fromIntegral<span style="color: #333333;"> </span><span style="color: #A197BF;">.</span><span style="color: #333333;"> </span>length)<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>group<span style="color: #333333;"> </span>comp
<span style="color: #333333;">    </span>comp'<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>filter<span style="color: #333333;"> </span>(<span style="color: #A197BF;">&gt;</span><span style="color: #333333;"> </span>0)<span style="color: #333333;"> </span>comp
<span style="color: #333333;">    </span>l2<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>ceiling<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span>
<span style="color: #333333;">         </span>log2'<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>foldr<span style="color: #333333;"> </span>(<span style="color: #A197BF;">\</span>x<span style="color: #333333;"> </span>acc<span style="color: #333333;"> </span><span style="color: #A197BF;">-&gt;</span><span style="color: #333333;"> </span>acc<span style="color: #333333;"> </span><span style="color: #A197BF;">`div`</span><span style="color: #333333;"> </span>(factorial<span style="color: #333333;"> </span>x))<span style="color: #333333;"> </span>(factorial<span style="color: #333333;"> </span>n)<span style="color: #333333;"> </span>comp'
<span style="color: #333333;">    </span>l11<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>ceiling<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>log2'<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>n<span style="color: #333333;"> </span><span style="color: #A197BF;">*</span><span style="color: #333333;"> </span>product<span style="color: #333333;"> </span>comp'
<span style="color: #333333;">    </span>l12<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>ceiling<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span>
<span style="color: #333333;">          </span>log2'<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span>
<span style="color: #333333;">          </span>foldr<span style="color: #333333;"> </span>(<span style="color: #A197BF;">\</span>x<span style="color: #333333;"> </span>acc<span style="color: #333333;"> </span><span style="color: #A197BF;">-&gt;</span><span style="color: #333333;"> </span>acc<span style="color: #333333;"> </span><span style="color: #A197BF;">`div`</span><span style="color: #333333;"> </span>(factorial<span style="color: #333333;"> </span>x))
<span style="color: #333333;">                </span>(factorial<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>fromIntegral<span style="color: #333333;"> </span><span style="color: #A197BF;">$</span><span style="color: #333333;"> </span>length<span style="color: #333333;"> </span>comp)
<span style="color: #333333;">                </span>compcomp
<span style="color: #333333;">    </span>l1<span style="color: #333333;"> </span><span style="color: #A197BF;">=</span><span style="color: #333333;"> </span>l11<span style="color: #333333;"> </span><span style="color: #A197BF;">+</span><span style="color: #333333;"> </span>l12
</pre>
</div>

<p>
First sorted composition: \(\tau =
  (13,11,8,8,5,5,4,4,3,2,2,1,1,1,1,1,1,0,0,..,0,0)\). Composition of
composition \(\tau' = (1,1,2,2,2,1,2,6,239)\). Length of the
composition \(l_1 = 154\), number of the proverb in list of strings
with this composition \(l_2 = 223\). Total information needed to
transmit the string: \(l = l_1+l_2 = 377\) bits. A little bit less
then with arithmetic coding, less then huffman.
</p>
</div>
</div>
<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">5</span> LZ77</h2>
<div class="outline-text-2" id="text-5">
<p>
Implemented version of LZ77 uses levenshtein's code described in
textbook (because elias and unary universal codes are less efficient
for current dataset). It uses window of size 100, more than
proverb's length.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">\(Flag\)</th>
<th scope="col" class="org-left">\(Substring\)</th>
<th scope="col" class="org-right">\(d\)</th>
<th scope="col" class="org-right">\(l\)</th>
<th scope="col" class="org-right">\(Codeword\)</th>
<th scope="col" class="org-right">\(Bits\)</th>
<th scope="col" class="org-right">\(Total\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">L</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001001100</td>
<td class="org-right">9</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">o</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001101111</td>
<td class="org-right">9</td>
<td class="org-right">18</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">v</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110110</td>
<td class="org-right">9</td>
<td class="org-right">27</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">e</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001100101</td>
<td class="org-right">9</td>
<td class="org-right">36</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">␣</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001011111</td>
<td class="org-right">9</td>
<td class="org-right">45</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">t</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110100</td>
<td class="org-right">9</td>
<td class="org-right">54</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">h</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001101000</td>
<td class="org-right">9</td>
<td class="org-right">63</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">e␣</td>
<td class="org-right">4</td>
<td class="org-right">2</td>
<td class="org-right">1100100</td>
<td class="org-right">7</td>
<td class="org-right">70</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">he</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">10011100</td>
<td class="org-right">8</td>
<td class="org-right">78</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">a</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001100001</td>
<td class="org-right">9</td>
<td class="org-right">87</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">r</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110010</td>
<td class="org-right">9</td>
<td class="org-right">96</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">t</td>
<td class="org-right">8</td>
<td class="org-right">1</td>
<td class="org-right">110000</td>
<td class="org-right">6</td>
<td class="org-right">102</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">␣th</td>
<td class="org-right">10</td>
<td class="org-right">3</td>
<td class="org-right">11010101</td>
<td class="org-right">8</td>
<td class="org-right">110</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">a</td>
<td class="org-right">6</td>
<td class="org-right">1</td>
<td class="org-right">1001100</td>
<td class="org-right">7</td>
<td class="org-right">117</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">t␣</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">100101100</td>
<td class="org-right">9</td>
<td class="org-right">126</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">h</td>
<td class="org-right">14</td>
<td class="org-right">1</td>
<td class="org-right">1011100</td>
<td class="org-right">7</td>
<td class="org-right">133</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">u</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110101</td>
<td class="org-right">9</td>
<td class="org-right">142</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">rt</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">101010100</td>
<td class="org-right">9</td>
<td class="org-right">151</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">s</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110011</td>
<td class="org-right">9</td>
<td class="org-right">160</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">␣</td>
<td class="org-right">21</td>
<td class="org-right">1</td>
<td class="org-right">1101010</td>
<td class="org-right">7</td>
<td class="org-right">167</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">y</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001111001</td>
<td class="org-right">9</td>
<td class="org-right">176</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">o</td>
<td class="org-right">26</td>
<td class="org-right">1</td>
<td class="org-right">1110100</td>
<td class="org-right">7</td>
<td class="org-right">183</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">u</td>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-right">1001110</td>
<td class="org-right">7</td>
<td class="org-right">190</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">,</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">000101100</td>
<td class="org-right">9</td>
<td class="org-right">199</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">␣</td>
<td class="org-right">26</td>
<td class="org-right">1</td>
<td class="org-right">1110100</td>
<td class="org-right">7</td>
<td class="org-right">206</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">b</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001100010</td>
<td class="org-right">9</td>
<td class="org-right">215</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">u</td>
<td class="org-right">11</td>
<td class="org-right">1</td>
<td class="org-right">10010110</td>
<td class="org-right">8</td>
<td class="org-right">223</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">t␣</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">1010100100</td>
<td class="org-right">10</td>
<td class="org-right">233</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">n</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001101110</td>
<td class="org-right">9</td>
<td class="org-right">242</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">e</td>
<td class="org-right">33</td>
<td class="org-right">1</td>
<td class="org-right">11000010</td>
<td class="org-right">8</td>
<td class="org-right">250</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">ve</td>
<td class="org-right">35</td>
<td class="org-right">2</td>
<td class="org-right">1100011100</td>
<td class="org-right">10</td>
<td class="org-right">260</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">r</td>
<td class="org-right">27</td>
<td class="org-right">1</td>
<td class="org-right">10110110</td>
<td class="org-right">8</td>
<td class="org-right">268</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">␣hurt</td>
<td class="org-right">21</td>
<td class="org-right">5</td>
<td class="org-right">101010111001</td>
<td class="org-right">12</td>
<td class="org-right">280</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">␣the␣heart␣that␣</td>
<td class="org-right">41</td>
<td class="org-right">16</td>
<td class="org-right">1101001111100000</td>
<td class="org-right">16</td>
<td class="org-right">296</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">l</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001101100</td>
<td class="org-right">9</td>
<td class="org-right">305</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">ove</td>
<td class="org-right">61</td>
<td class="org-right">3</td>
<td class="org-right">1111101101</td>
<td class="org-right">10</td>
<td class="org-right">315</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">s␣you</td>
<td class="org-right">41</td>
<td class="org-right">5</td>
<td class="org-right">1010100111001</td>
<td class="org-right">13</td>
<td class="org-right">328</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">.</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">000101110</td>
<td class="org-right">9</td>
<td class="org-right">337</td>
</tr>
</tbody>
</table>

<p>
Here's also results for other universal codes (smaller windows
affect length dramatically because of that "the heart that" chunk in
the end. Best performance of levenshtein is achieved because its
encoding of "1" takes only 1 bit (compared to 2 bits of elias) and
it's more effective then unary on bigger numbers. In general i
expect elias to perform better.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" align="center" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Code\)</th>
<th scope="col" class="org-right">\(W\)</th>
<th scope="col" class="org-right">\(L\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Unary</td>
<td class="org-right">45</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">50</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">55</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">60</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">65</td>
<td class="org-right">338</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">70</td>
<td class="org-right">338</td>
</tr>

<tr>
<td class="org-left">Unary</td>
<td class="org-right">75</td>
<td class="org-right">338</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">45</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">50</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">55</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">60</td>
<td class="org-right">344</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">65</td>
<td class="org-right">337</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">70</td>
<td class="org-right">337</td>
</tr>

<tr>
<td class="org-left">Levenshtein</td>
<td class="org-right">75</td>
<td class="org-right">337</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">45</td>
<td class="org-right">358</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">50</td>
<td class="org-right">358</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">55</td>
<td class="org-right">358</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">60</td>
<td class="org-right">358</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">65</td>
<td class="org-right">350</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">70</td>
<td class="org-right">350</td>
</tr>

<tr>
<td class="org-left">Elias</td>
<td class="org-right">75</td>
<td class="org-right">350</td>
</tr>
</tbody>
</table>

<p>
So in conclusion we've achieved \(l = 337\) bits, which is the best
result among experiments for now.
</p>
</div>
</div>
<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6"><span class="section-number-2">6</span> LZW</h2>
<div class="outline-text-2" id="text-6">
<p>
I've implemented LZW algorithm with escape symbol and matched it
with the test proverb (if we cannot&#x2026;), got 291 bit as in the
textbook. Here are the result on the real proverb:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Dictionary\)</th>
<th scope="col" class="org-left">\(Match\)</th>
<th scope="col" class="org-right">\(Dict\) \(index\)</th>
<th scope="col" class="org-right">\(Codeword\)</th>
<th scope="col" class="org-right">\(Bits\)</th>
<th scope="col" class="org-right">\(Total\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">L</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">01001100</td>
<td class="org-right">8</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">01101111</td>
<td class="org-right">8</td>
<td class="org-right">16</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">001110110</td>
<td class="org-right">9</td>
<td class="org-right">25</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0001100101</td>
<td class="org-right">10</td>
<td class="org-right">35</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0001011111</td>
<td class="org-right">10</td>
<td class="org-right">45</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">00001110100</td>
<td class="org-right">11</td>
<td class="org-right">56</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">00001101000</td>
<td class="org-right">11</td>
<td class="org-right">67</td>
</tr>

<tr>
<td class="org-left">e␣</td>
<td class="org-left">e</td>
<td class="org-right">4</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">70</td>
</tr>

<tr>
<td class="org-left">␣h</td>
<td class="org-left">␣</td>
<td class="org-right">5</td>
<td class="org-right">101</td>
<td class="org-right">3</td>
<td class="org-right">73</td>
</tr>

<tr>
<td class="org-left">he</td>
<td class="org-left">h</td>
<td class="org-right">7</td>
<td class="org-right">0111</td>
<td class="org-right">4</td>
<td class="org-right">77</td>
</tr>

<tr>
<td class="org-left">ea</td>
<td class="org-left">e</td>
<td class="org-right">4</td>
<td class="org-right">0100</td>
<td class="org-right">4</td>
<td class="org-right">81</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">000001100001</td>
<td class="org-right">12</td>
<td class="org-right">93</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">000001110010</td>
<td class="org-right">12</td>
<td class="org-right">105</td>
</tr>

<tr>
<td class="org-left">t␣</td>
<td class="org-left">t</td>
<td class="org-right">6</td>
<td class="org-right">0110</td>
<td class="org-right">4</td>
<td class="org-right">109</td>
</tr>

<tr>
<td class="org-left">␣t</td>
<td class="org-left">␣</td>
<td class="org-right">5</td>
<td class="org-right">0101</td>
<td class="org-right">4</td>
<td class="org-right">113</td>
</tr>

<tr>
<td class="org-left">th</td>
<td class="org-left">t</td>
<td class="org-right">6</td>
<td class="org-right">0110</td>
<td class="org-right">4</td>
<td class="org-right">117</td>
</tr>

<tr>
<td class="org-left">ha</td>
<td class="org-left">h</td>
<td class="org-right">7</td>
<td class="org-right">0111</td>
<td class="org-right">4</td>
<td class="org-right">121</td>
</tr>

<tr>
<td class="org-left">at</td>
<td class="org-left">a</td>
<td class="org-right">12</td>
<td class="org-right">01100</td>
<td class="org-right">5</td>
<td class="org-right">126</td>
</tr>

<tr>
<td class="org-left">t␣h</td>
<td class="org-left">t␣</td>
<td class="org-right">14</td>
<td class="org-right">01110</td>
<td class="org-right">5</td>
<td class="org-right">131</td>
</tr>

<tr>
<td class="org-left">hu</td>
<td class="org-left">h</td>
<td class="org-right">7</td>
<td class="org-right">00111</td>
<td class="org-right">5</td>
<td class="org-right">136</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0000001110101</td>
<td class="org-right">13</td>
<td class="org-right">149</td>
</tr>

<tr>
<td class="org-left">rt</td>
<td class="org-left">r</td>
<td class="org-right">13</td>
<td class="org-right">01101</td>
<td class="org-right">5</td>
<td class="org-right">154</td>
</tr>

<tr>
<td class="org-left">ts</td>
<td class="org-left">t</td>
<td class="org-right">6</td>
<td class="org-right">00110</td>
<td class="org-right">5</td>
<td class="org-right">159</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0000001110011</td>
<td class="org-right">13</td>
<td class="org-right">172</td>
</tr>

<tr>
<td class="org-left">␣y</td>
<td class="org-left">␣</td>
<td class="org-right">5</td>
<td class="org-right">00101</td>
<td class="org-right">5</td>
<td class="org-right">177</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0000001111001</td>
<td class="org-right">13</td>
<td class="org-right">190</td>
</tr>

<tr>
<td class="org-left">ou</td>
<td class="org-left">o</td>
<td class="org-right">2</td>
<td class="org-right">00010</td>
<td class="org-right">5</td>
<td class="org-right">195</td>
</tr>

<tr>
<td class="org-left">u,</td>
<td class="org-left">u</td>
<td class="org-right">21</td>
<td class="org-right">10101</td>
<td class="org-right">5</td>
<td class="org-right">200</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0000000101100</td>
<td class="org-right">13</td>
<td class="org-right">213</td>
</tr>

<tr>
<td class="org-left">␣b</td>
<td class="org-left">␣</td>
<td class="org-right">5</td>
<td class="org-right">00101</td>
<td class="org-right">5</td>
<td class="org-right">218</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">0000001100010</td>
<td class="org-right">13</td>
<td class="org-right">231</td>
</tr>

<tr>
<td class="org-left">ut</td>
<td class="org-left">u</td>
<td class="org-right">21</td>
<td class="org-right">10101</td>
<td class="org-right">5</td>
<td class="org-right">236</td>
</tr>

<tr>
<td class="org-left">t␣n</td>
<td class="org-left">t␣</td>
<td class="org-right">14</td>
<td class="org-right">01110</td>
<td class="org-right">5</td>
<td class="org-right">241</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">00000001101110</td>
<td class="org-right">14</td>
<td class="org-right">255</td>
</tr>

<tr>
<td class="org-left">ev</td>
<td class="org-left">e</td>
<td class="org-right">4</td>
<td class="org-right">000100</td>
<td class="org-right">6</td>
<td class="org-right">261</td>
</tr>

<tr>
<td class="org-left">ve</td>
<td class="org-left">v</td>
<td class="org-right">3</td>
<td class="org-right">000011</td>
<td class="org-right">6</td>
<td class="org-right">267</td>
</tr>

<tr>
<td class="org-left">er</td>
<td class="org-left">e</td>
<td class="org-right">4</td>
<td class="org-right">000100</td>
<td class="org-right">6</td>
<td class="org-right">273</td>
</tr>

<tr>
<td class="org-left">r␣</td>
<td class="org-left">r</td>
<td class="org-right">13</td>
<td class="org-right">001101</td>
<td class="org-right">6</td>
<td class="org-right">279</td>
</tr>

<tr>
<td class="org-left">␣hu</td>
<td class="org-left">␣h</td>
<td class="org-right">9</td>
<td class="org-right">001001</td>
<td class="org-right">6</td>
<td class="org-right">285</td>
</tr>

<tr>
<td class="org-left">ur</td>
<td class="org-left">u</td>
<td class="org-right">21</td>
<td class="org-right">010101</td>
<td class="org-right">6</td>
<td class="org-right">291</td>
</tr>

<tr>
<td class="org-left">rt␣</td>
<td class="org-left">rt</td>
<td class="org-right">22</td>
<td class="org-right">010110</td>
<td class="org-right">6</td>
<td class="org-right">297</td>
</tr>

<tr>
<td class="org-left">␣th</td>
<td class="org-left">␣t</td>
<td class="org-right">15</td>
<td class="org-right">001111</td>
<td class="org-right">6</td>
<td class="org-right">303</td>
</tr>

<tr>
<td class="org-left">he␣</td>
<td class="org-left">he</td>
<td class="org-right">10</td>
<td class="org-right">001010</td>
<td class="org-right">6</td>
<td class="org-right">309</td>
</tr>

<tr>
<td class="org-left">␣he</td>
<td class="org-left">␣h</td>
<td class="org-right">9</td>
<td class="org-right">001001</td>
<td class="org-right">6</td>
<td class="org-right">315</td>
</tr>

<tr>
<td class="org-left">ear</td>
<td class="org-left">ea</td>
<td class="org-right">11</td>
<td class="org-right">001011</td>
<td class="org-right">6</td>
<td class="org-right">321</td>
</tr>

<tr>
<td class="org-left">rt␣t</td>
<td class="org-left">rt␣</td>
<td class="org-right">41</td>
<td class="org-right">101001</td>
<td class="org-right">6</td>
<td class="org-right">327</td>
</tr>

<tr>
<td class="org-left">tha</td>
<td class="org-left">th</td>
<td class="org-right">16</td>
<td class="org-right">010000</td>
<td class="org-right">6</td>
<td class="org-right">333</td>
</tr>

<tr>
<td class="org-left">at␣</td>
<td class="org-left">at</td>
<td class="org-right">18</td>
<td class="org-right">010010</td>
<td class="org-right">6</td>
<td class="org-right">339</td>
</tr>

<tr>
<td class="org-left">␣l</td>
<td class="org-left">␣</td>
<td class="org-right">5</td>
<td class="org-right">000101</td>
<td class="org-right">6</td>
<td class="org-right">345</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">00000001101100</td>
<td class="org-right">14</td>
<td class="org-right">359</td>
</tr>

<tr>
<td class="org-left">ov</td>
<td class="org-left">o</td>
<td class="org-right">2</td>
<td class="org-right">000010</td>
<td class="org-right">6</td>
<td class="org-right">365</td>
</tr>

<tr>
<td class="org-left">ves</td>
<td class="org-left">ve</td>
<td class="org-right">36</td>
<td class="org-right">100100</td>
<td class="org-right">6</td>
<td class="org-right">371</td>
</tr>

<tr>
<td class="org-left">s␣</td>
<td class="org-left">s</td>
<td class="org-right">24</td>
<td class="org-right">011000</td>
<td class="org-right">6</td>
<td class="org-right">377</td>
</tr>

<tr>
<td class="org-left">␣yo</td>
<td class="org-left">␣y</td>
<td class="org-right">25</td>
<td class="org-right">011001</td>
<td class="org-right">6</td>
<td class="org-right">383</td>
</tr>

<tr>
<td class="org-left">ou.</td>
<td class="org-left">ou</td>
<td class="org-right">27</td>
<td class="org-right">011011</td>
<td class="org-right">6</td>
<td class="org-right">389</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">00000000101110</td>
<td class="org-right">14</td>
<td class="org-right">403</td>
</tr>
</tbody>
</table>

<p>
Well, results (\(l = 403\) bits) are clearly worse than they were with
previous coding algorithms. On the contrary, LZW implementation is
pretty simple and straight-forward. I assume that the biggest
problem of LZW here is the big variety of new symbols (rather big) comparing to
the length of input data &#x2013; we've spent a lot of bits to transmit
new characters, especially coding escape symbol. Should perform
better then lz77 on bigger datasets.
</p>

<p>
For comparison i've taken this phrase that's 74 words and 500 bytes
of lorem ipsum text:
</p>

<blockquote>
<p>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras ornare
diam nec interdum mollis. Phasellus tortor felis, dapibus eu
bibendum eu, commodo quis erat. Vestibulum fringilla, purus semper
eleifend laoreet, sem dui volutpat lectus, sed ullamcorper ante
neque id lectus. Nulla ullamcorper egestas nisl, at convallis leo
tempus vel. Sed mi lacus, aliquam ullamcorper purus vitae, vulputate
dignissim ipsum. Nam in est eu quam maximus blandit. Integer nec
iaculis felis. Vestibulum ut cras amet.
</p>
</blockquote>

<p>
Here's a comparison of LZW/LZ77 with different window sizes and
universal codes. Maximum windows size is 4000 (500 bytes):
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Algorithm\)</th>
<th scope="col" class="org-left">\(W\)</th>
<th scope="col" class="org-right">\(Universal Code\)</th>
<th scope="col" class="org-right">\(Total bits\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">LZW</td>
<td class="org-left">∅</td>
<td class="org-right">∅</td>
<td class="org-right">2617</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">500</td>
<td class="org-right">2761</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">1000</td>
<td class="org-right">2761</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">2000</td>
<td class="org-right">2761</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">4000</td>
<td class="org-right">2761</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">500</td>
<td class="org-right">2835</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">1000</td>
<td class="org-right">2835</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">2000</td>
<td class="org-right">2835</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">4000</td>
<td class="org-right">2835</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">200</td>
<td class="org-right">2932</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">500</td>
<td class="org-right">2949</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">1000</td>
<td class="org-right">2949</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">2000</td>
<td class="org-right">2949</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">4000</td>
<td class="org-right">2949</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">200</td>
<td class="org-right">3021</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">100</td>
<td class="org-right">3048</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">100</td>
<td class="org-right">3132</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">200</td>
<td class="org-right">3148</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Unary</td>
<td class="org-right">50</td>
<td class="org-right">3283</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">100</td>
<td class="org-right">3305</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Levenshtein</td>
<td class="org-right">50</td>
<td class="org-right">3346</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-left">Elias</td>
<td class="org-right">50</td>
<td class="org-right">3591</td>
</tr>
</tbody>
</table>

<p>
Interestingly, unary universal coding performs on average better
than levenshtein/elias. And most importantly, our assumption
appeared to be correct &#x2013; LZW saves us \(144\) bits (0.34 percent).
</p>
</div>
</div>
<div id="outline-container-orgheadline7" class="outline-2">
<h2 id="orgheadline7"><span class="section-number-2">7</span> PPM</h2>
<div class="outline-text-2" id="text-7">
<p>
I've chosen PPMA as main algorithm to implement because it's simpler
to debug. I've added support of exceptions. First thing I need to
say is that table 4.5 of the textbook has a mistake. On step 39
\(p(a|s)\) is calculated incorrectly: initial context \(s\) <code>OULD_</code> is
matched once before on the step \(24\) (as it's written in \(τ_t(s)\) of
step 39), then it's reduced three times to <code>_</code>. Notice that no
bigger suffix of <code>OULD_</code> (then <code>_</code>) is matched in other places
before &#x2013; there's only one <code>D_</code> at string's position 27. So \(τ_t(s)\)
of step 39 says that <code>_</code> is found 8 times. Indeed &#x2013; on positions
\(3, 6, 13, 16, 19, 22, 28, 31\). Using exceptions rule we ignore all
<code>_</code> that are followed by characters that followed any of our
pre-contexts: one of <code>OULD_</code>, <code>ULD_</code>, <code>LD_</code>, <code>D_</code>. But that's
exactly only one character <code>W</code>. So positions \(6, 13, 17, 31\) are
left (and on position 13 <code>_</code> is followed by <code>D</code>), which gives us a
probability of <code>D</code> after <code>_</code>:
</p>

\begin{align*}
p_t(a|s) = \frac{τ_t(s,a)}{τ_t(s)+1} = \frac{1}{4+1} = \frac{1}{5}
\end{align*}

<p>
Textbook says that correct probability is \(\frac{1}{4}\). So that's a
mistake in my opinion. The correct length of coded string is this
\(249\) bits, not \(250\).
</p>

<p>
Back to the task proverb. Here's a table with algorithm trace,
launched with \(D = 5\):
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%; float: left;">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Char\)</th>
<th scope="col" class="org-left">\(Context\) \(s\)</th>
<th scope="col" class="org-right">\(τ_t(s)\)</th>
<th scope="col" class="org-left">\(p_t(esc \mid s)\)</th>
<th scope="col" class="org-left">\(p_t(a \mid s)\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">L</td>
<td class="org-left">#</td>
<td class="org-right">0</td>
<td class="org-left">1/1</td>
<td class="org-left">1/256</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">#</td>
<td class="org-right">1</td>
<td class="org-left">1/2</td>
<td class="org-left">1/255</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">#</td>
<td class="org-right">2</td>
<td class="org-left">1/3</td>
<td class="org-left">1/254</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">#</td>
<td class="org-right">3</td>
<td class="org-left">1/4</td>
<td class="org-left">1/253</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">#</td>
<td class="org-right">4</td>
<td class="org-left">1/5</td>
<td class="org-left">1/252</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">#</td>
<td class="org-right">5</td>
<td class="org-left">1/6</td>
<td class="org-left">1/251</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">#</td>
<td class="org-right">6</td>
<td class="org-left">1/7</td>
<td class="org-left">1/250</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">#</td>
<td class="org-right">7</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/8</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"e"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"e␣"</td>
<td class="org-right">1,1,9</td>
<td class="org-left">1/2,1/1</td>
<td class="org-left">1/9</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">"h"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">"he"</td>
<td class="org-right">1,2,11</td>
<td class="org-left">1/2,1/1,1/10</td>
<td class="org-left">1/249</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">#</td>
<td class="org-right">12</td>
<td class="org-left">1/13</td>
<td class="org-left">1/248</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">#</td>
<td class="org-right">13</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/14</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"t"</td>
<td class="org-right">1,14</td>
<td class="org-left">1/2</td>
<td class="org-left">2/13</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"␣"</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/3</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"␣t"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">"␣th"</td>
<td class="org-right">1,1,2,17</td>
<td class="org-left">1/2,1/1,1/1</td>
<td class="org-left">1/15</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"a"</td>
<td class="org-right">1,18</td>
<td class="org-left">1/2</td>
<td class="org-left">1/6</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"t"</td>
<td class="org-right">3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/4</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"t␣"</td>
<td class="org-right">1,3</td>
<td class="org-left">1/2</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">"␣h"</td>
<td class="org-right">1,3,21</td>
<td class="org-left">1/2,1/2,1/17</td>
<td class="org-left">1/247</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">#</td>
<td class="org-right">22</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/23</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"r"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">"rt"</td>
<td class="org-right">1,4,24</td>
<td class="org-left">1/2,1/3,1/17</td>
<td class="org-left">1/246</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">#</td>
<td class="org-right">25</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">2/13</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">"␣"</td>
<td class="org-right">4,26</td>
<td class="org-left">1/5,1/18</td>
<td class="org-left">1/245</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">#</td>
<td class="org-right">27</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/28</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">"o"</td>
<td class="org-right">1,28</td>
<td class="org-left">1/2</td>
<td class="org-left">1/28</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-left">"u"</td>
<td class="org-right">1,29</td>
<td class="org-left">1/2,1/28</td>
<td class="org-left">1/244</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">#</td>
<td class="org-right">30</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">5/31</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">"␣"</td>
<td class="org-right">5,31</td>
<td class="org-left">1/6,1/22</td>
<td class="org-left">1/243</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">#</td>
<td class="org-right">32</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">2/33</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"u"</td>
<td class="org-right">2,33</td>
<td class="org-left">1/3</td>
<td class="org-left">5/31</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"t"</td>
<td class="org-right">5</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/3</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-left">"t␣"</td>
<td class="org-right">2,6,35</td>
<td class="org-left">1/3,1/3,1/24</td>
<td class="org-left">1/242</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">#</td>
<td class="org-right">36</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">3/37</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">"e"</td>
<td class="org-right">3,37</td>
<td class="org-left">1/4</td>
<td class="org-left">1/29</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">"v"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">"ve"</td>
<td class="org-right">1,4,39</td>
<td class="org-left">1/2,1/3</td>
<td class="org-left">2/29</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"r"</td>
<td class="org-right">2,40</td>
<td class="org-left">1/3</td>
<td class="org-left">1/5</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"␣"</td>
<td class="org-right">7</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/4</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">"␣h"</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/3</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">"␣hu"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"␣hur"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"␣hurt"</td>
<td class="org-right">1,1,1,2</td>
<td class="org-left">1/2,1/1,1/1</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"rt␣"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"rt␣t"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">"rt␣th"</td>
<td class="org-right">1,1,2</td>
<td class="org-left">1/2,1/1</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"␣the"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"␣the␣"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">"the␣h"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">"he␣he"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">"e␣hea"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"␣hear"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"heart"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"eart␣"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">"art␣t"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">"rt␣th"</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/3</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">"t␣tha"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"␣that"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-left">"that␣"</td>
<td class="org-right">1,1,1,5,11,61</td>
<td class="org-left">1/2,1/1,1/1,1/5,1/3,1/40</td>
<td class="org-left">1/241</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">#</td>
<td class="org-right">62</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">2/63</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-left">"o"</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/3</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">"ov"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">"ove"</td>
<td class="org-right">1,2,7,65</td>
<td class="org-left">1/2,1/2,1/4</td>
<td class="org-left">1/42</td>
</tr>

<tr>
<td class="org-left">␣</td>
<td class="org-left">"s"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-left">"s␣"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">"s␣y"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-left">"s␣yo"</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">1/2</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">"s␣you"</td>
<td class="org-right">1,1,1,1,4,70</td>
<td class="org-left">1/2,1/1,1/1,1/1,1/4,1/54</td>
<td class="org-left">1/240</td>
</tr>
</tbody>
</table>

<p>
Finaly we have \(l = 345 + 1 = 346\) bits. Result is pretty good, much
better then previous algorithm implementations. Here's also a
comparison table for different \(D\) &#x2013; both original proverb and
lorem ipsum text mentioned in the previous section:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">\(D\)</th>
<th scope="col" class="org-right">\(Proverb\)</th>
<th scope="col" class="org-right">\(Lorem\) \(Ipsum\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">358</td>
<td class="org-right">2340</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">348</td>
<td class="org-right">2355</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">345</td>
<td class="org-right">2364</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">345</td>
<td class="org-right">2367</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">346</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-right">345</td>
<td class="org-right">2366</td>
</tr>
</tbody>
</table>

<p>
Thus we can see that in general big window \(D\) doesn't help with
english text, because on average coincedences of big words (&gt;5
symbols) are pretty rare.
</p>
</div>
</div>
<div id="outline-container-orgheadline8" class="outline-2">
<h2 id="orgheadline8"><span class="section-number-2">8</span> Burrows-Wheeler + book stack</h2>
<div class="outline-text-2" id="text-8">
<p>
Implemented algorithm uses Burrows-Wheeler transformation with MTF
(book stack) algorithm together to obtain results. That's a first
round, straight-forward MTF without escapes.
</p>

<p>
One thing to mention before is that I'm encoding \(diff+1\) where
\(diff\) is a number of different words between current and previous
occurences of the char because universal coding work only in range
\({1..}\), whereas \(diff\) can be zero (example &#x2013; <code>aaaa</code>). Used
universal coding is monotonic (levenshtein). When character is not
in the history, i'm assuming there's a list of all ascii characters
(length 256) before the processed string.
</p>

<p>
First, let's perform the transformation. Here's the result:
</p>

<p>
<code>uu.,eertttttetsseehh_hhvhhvvntttt______yyLleaauuteaaurrr____roohhboeo__</code>
</p>

<p>
And the number of this string in sorted list is 3 (index 2). Here's
a table that shows how algorithm worked:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Char\)</th>
<th scope="col" class="org-right">\(New\)</th>
<th scope="col" class="org-right">\(Dist\)</th>
<th scope="col" class="org-right">\(Diff\)</th>
<th scope="col" class="org-right">\(Code\) \(word\)</th>
<th scope="col" class="org-right">\(Bits\)</th>
<th scope="col" class="org-right">\(Total\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">u</td>
<td class="org-right">1</td>
<td class="org-right">139</td>
<td class="org-right">139</td>
<td class="org-right">1110110001100</td>
<td class="org-right">13</td>
<td class="org-right">13</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-right">1</td>
<td class="org-right">212</td>
<td class="org-right">211</td>
<td class="org-right">1110111010100</td>
<td class="org-right">13</td>
<td class="org-right">28</td>
</tr>

<tr>
<td class="org-left">,</td>
<td class="org-right">1</td>
<td class="org-right">215</td>
<td class="org-right">214</td>
<td class="org-right">1110111010111</td>
<td class="org-right">13</td>
<td class="org-right">41</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">1</td>
<td class="org-right">159</td>
<td class="org-right">158</td>
<td class="org-right">1110110011111</td>
<td class="org-right">13</td>
<td class="org-right">54</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">56</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">1</td>
<td class="org-right">148</td>
<td class="org-right">146</td>
<td class="org-right">1110110010011</td>
<td class="org-right">13</td>
<td class="org-right">69</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">1</td>
<td class="org-right">147</td>
<td class="org-right">145</td>
<td class="org-right">1110110010010</td>
<td class="org-right">13</td>
<td class="org-right">82</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">84</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">86</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">88</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">90</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">8</td>
<td class="org-right">2</td>
<td class="org-right">101</td>
<td class="org-right">3</td>
<td class="org-right">93</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">96</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-right">1</td>
<td class="org-right">155</td>
<td class="org-right">147</td>
<td class="org-right">1110110010100</td>
<td class="org-right">13</td>
<td class="org-right">109</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">111</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">101</td>
<td class="org-right">3</td>
<td class="org-right">114</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">116</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">1</td>
<td class="org-right">170</td>
<td class="org-right">159</td>
<td class="org-right">1110110100000</td>
<td class="org-right">13</td>
<td class="org-right">129</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">131</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">1</td>
<td class="org-right">181</td>
<td class="org-right">169</td>
<td class="org-right">1110110101010</td>
<td class="org-right">13</td>
<td class="org-right">144</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">147</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">149</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">1</td>
<td class="org-right">161</td>
<td class="org-right">147</td>
<td class="org-right">1110110010100</td>
<td class="org-right">13</td>
<td class="org-right">162</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">165</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">167</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">0</td>
<td class="org-right">4</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">170</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">172</td>
</tr>

<tr>
<td class="org-left">n</td>
<td class="org-right">1</td>
<td class="org-right">174</td>
<td class="org-right">156</td>
<td class="org-right">1110110011101</td>
<td class="org-right">13</td>
<td class="org-right">185</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">17</td>
<td class="org-right">6</td>
<td class="org-right">110011</td>
<td class="org-right">6</td>
<td class="org-right">191</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">193</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">195</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">197</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">14</td>
<td class="org-right">4</td>
<td class="org-right">110001</td>
<td class="org-right">6</td>
<td class="org-right">203</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">205</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">207</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">209</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">211</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">213</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">1</td>
<td class="org-right">174</td>
<td class="org-right">146</td>
<td class="org-right">1110110010011</td>
<td class="org-right">13</td>
<td class="org-right">226</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">228</td>
</tr>

<tr>
<td class="org-left">L</td>
<td class="org-right">1</td>
<td class="org-right">221</td>
<td class="org-right">192</td>
<td class="org-right">1110111000001</td>
<td class="org-right">13</td>
<td class="org-right">241</td>
</tr>

<tr>
<td class="org-left">l</td>
<td class="org-right">1</td>
<td class="org-right">190</td>
<td class="org-right">161</td>
<td class="org-right">1110110100010</td>
<td class="org-right">13</td>
<td class="org-right">254</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">27</td>
<td class="org-right">8</td>
<td class="org-right">1101001</td>
<td class="org-right">7</td>
<td class="org-right">261</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-right">1</td>
<td class="org-right">203</td>
<td class="org-right">173</td>
<td class="org-right">1110110101110</td>
<td class="org-right">13</td>
<td class="org-right">274</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">276</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">0</td>
<td class="org-right">46</td>
<td class="org-right">14</td>
<td class="org-right">1101111</td>
<td class="org-right">7</td>
<td class="org-right">283</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">285</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-right">0</td>
<td class="org-right">17</td>
<td class="org-right">7</td>
<td class="org-right">1101000</td>
<td class="org-right">7</td>
<td class="org-right">292</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">3</td>
<td class="org-right">110000</td>
<td class="org-right">6</td>
<td class="org-right">298</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">3</td>
<td class="org-right">110000</td>
<td class="org-right">6</td>
<td class="org-right">304</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">306</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">3</td>
<td class="org-right">110000</td>
<td class="org-right">6</td>
<td class="org-right">312</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">0</td>
<td class="org-right">48</td>
<td class="org-right">12</td>
<td class="org-right">1101101</td>
<td class="org-right">7</td>
<td class="org-right">319</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">321</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">323</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">19</td>
<td class="org-right">8</td>
<td class="org-right">1101001</td>
<td class="org-right">7</td>
<td class="org-right">330</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">332</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">334</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">336</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">339</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-right">1</td>
<td class="org-right">206</td>
<td class="org-right">160</td>
<td class="org-right">1110110100001</td>
<td class="org-right">13</td>
<td class="org-right">352</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">354</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">39</td>
<td class="org-right">12</td>
<td class="org-right">1101101</td>
<td class="org-right">7</td>
<td class="org-right">361</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">363</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-right">1</td>
<td class="org-right">223</td>
<td class="org-right">174</td>
<td class="org-right">1110110101111</td>
<td class="org-right">13</td>
<td class="org-right">376</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">101</td>
<td class="org-right">3</td>
<td class="org-right">379</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-right">0</td>
<td class="org-right">19</td>
<td class="org-right">7</td>
<td class="org-right">1101000</td>
<td class="org-right">7</td>
<td class="org-right">386</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">100</td>
<td class="org-right">3</td>
<td class="org-right">389</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">11</td>
<td class="org-right">5</td>
<td class="org-right">110010</td>
<td class="org-right">6</td>
<td class="org-right">395</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-right">397</td>
</tr>
</tbody>
</table>

<p>
So we get \(393\) bits in total for transmitting this sequence using
straight-forward MTF method. Also index \(3\) from BWT will take 3
bits if encoded using elias coding. So in total \(396\) bits. Already
better than raw \(568\), but worse than algorithms mentioned
before. Performance with other universal codes is worse &#x2013; \(400\) in
total with elias and \(2975\) in total with unary (no wonder, encoding
big numbers takes a lot).
</p>

<p>
Let's take another approach with escape symbols and enumerative
coding which is described in part 4.6 of the textbook.
</p>

<p>
Running mtfs transfromation will yield this result:
</p>

<p>
<code>esc 0 esc esc esc 0 esc esc 0 0 0 0 2 1 esc 0 2 0 esc 0 esc 1 0 esc 1 0 1 0 esc 6 0 0 0 4 0 0 0 0 0 esc 0 esc esc 8 esc 0 14 0 7 3 3 0 3 12 0 0 8 0 0 0 1 esc 0 12 0 esc 2 7 1 5 0</code>
</p>

<p>
Coding it using enumerative coding gives us \(267\) bits (i just ran a
function <code>enumerative</code>, it doesn't trace anything). Transferring a
character per escape with 17 escapes in total gives us \(17 × 8 =
  136\) bits. Summing up, we get \(267 + 136 + 3 = 406\) (remember 3 bits
from BWT). Less than with straight-forward MTF coding. Both
approaches are pretty simple to implement on the other hand.
</p>
</div>
</div>
<div id="outline-container-orgheadline9" class="outline-2">
<h2 id="orgheadline9"><span class="section-number-2">9</span> Standart archiving</h2>
<div class="outline-text-2" id="text-9">
<p>
Last step is try to apply some standart archiving functions to our
proverb. I'll be really simple here and try it out with <code>GZip</code>
algorithm from library <code>zlib</code><sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup>. It uses "Deflate" algorithm
that's a combination of LZ77 and Huffman coding<sup><a id="fnr.4" class="footref" href="#fn.4">4</a></sup>.
</p>

<p>
So results are pretty sad for the current proverb: \(l = 544\), only
slightly lower than original \(568\) bits. On the other hand, lorem
ipsum text is compressed from \(4000\) to \(2472\) bits, which is a
significant performance boost. Small texts are not that
representative anyways.
</p>
</div>
</div>
<div id="outline-container-orgheadline10" class="outline-2">
<h2 id="orgheadline10"><span class="section-number-2">10</span> Comparison and summary</h2>
<div class="outline-text-2" id="text-10">
<p>
Let's compare all approaches we used:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" style="line-height: 7px; width: 100%;">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(Method\)</th>
<th scope="col" class="org-right">\(Bits\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Plain</td>
<td class="org-right">568</td>
</tr>

<tr>
<td class="org-left">Two pass huffman</td>
<td class="org-right">394</td>
</tr>

<tr>
<td class="org-left">Adaptive arithmetic</td>
<td class="org-right">385</td>
</tr>

<tr>
<td class="org-left">Enumerative</td>
<td class="org-right">377</td>
</tr>

<tr>
<td class="org-left">LZ77</td>
<td class="org-right">337</td>
</tr>

<tr>
<td class="org-left">LZW</td>
<td class="org-right">403</td>
</tr>

<tr>
<td class="org-left">PPMA</td>
<td class="org-right">346</td>
</tr>

<tr>
<td class="org-left">BW+MTF plain</td>
<td class="org-right">396</td>
</tr>

<tr>
<td class="org-left">BW+MTF enumerative</td>
<td class="org-right">406</td>
</tr>

<tr>
<td class="org-left">GZip</td>
<td class="org-right">544</td>
</tr>
</tbody>
</table>

<p>
It's hard to say which one is better in general, but in our case
LZ77 is as absolute winner (though we used a large window which is
not suitable for real usage), PPMA is the second one (more or
lessfair). GZip showed the worst together with LZW. We don't compare
speed efficiency of algorithms which is important parameter,
comparing compression rate doesn't really make the sense in general
&#x2013; different tasks define different requirements for encoding
algorithms. Another conclusion (that was covered in textbook too) is
that two-pass algorithms are not that much better comparing to
one-pass and it's clearly true based on our comparison table.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
<a href="https://en.wikipedia.org/wiki/Arithmetic_coding#Precision_and_renormalization">https://en.wikipedia.org/wiki/Arithmetic_coding#Precision_and_renormalization</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
<a href="http://www.hpl.hp.com/techreports/2004/HPL-2004-76.pdf">http://www.hpl.hp.com/techreports/2004/HPL-2004-76.pdf</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
<a href="https://hackage.haskell.org/package/zlib-0.6.1.1/docs/Codec-Compression-GZip.html">https://hackage.haskell.org/package/zlib-0.6.1.1/docs/Codec-Compression-GZip.html</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4">4</a></sup> <div class="footpara"><p class="footpara">
<a href="http://zlib.net/">http://zlib.net/</a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Volkhov Mikhail, M3338</p>
<p class="date">Created: 2016-12-18 Sun 17:13</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
